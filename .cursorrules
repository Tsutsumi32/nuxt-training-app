# Nuxt 4 ポートフォリオサイト - Cursor ルール

## プロジェクト概要

このプロジェクトは**Nuxt 4（最新版）**を使用したポートフォリオサイトです。
- **フレームワーク**: Nuxt 4（最新版）
- **言語**: TypeScript
- **UIフレームワーク**: Vue 3
- **ビルド方式**: SSG（Static Site Generation）
- **コンテナ**: Docker / Docker Compose

## 技術スタック

- **Nuxt**: 4.x（最新版）- `package.json`で`"nuxt": "latest"`を使用
- **TypeScript**: 5.3.3以上
- **Vue**: 3.x（Nuxt 4に含まれる）
- **Node.js**: 20.x（Alpine Linuxベース）

## ディレクトリ構造

```
app/
├── components/           # 再利用可能なコンポーネント（自動インポート）
│   ├── app/              # アプリケーション全体で使用されるコンポーネント
│   │   ├── Header.vue    # → <AppHeader />
│   │   └── Footer.vue    # → <AppFooter />
│   └── base/             # 基本的な再利用可能なコンポーネント
│       ├── Button.vue    # → <BaseButton />
│       └── Card.vue      # → <BaseCard />
├── layouts/              # レイアウトコンポーネント
│   └── default.vue
├── pages/                # ページコンポーネント（ファイルベースルーティング）
│   ├── index.vue         # /
│   ├── about.vue         # /about
│   ├── works.vue         # /works
│   └── contact.vue       # /contact
├── composables/          # コンポーザブル関数（自動インポート）
│   └── useTheme.ts
├── utils/                # ユーティリティ関数
│   └── formatters.ts
├── assets/               # 静的アセット
│   ├── css/              # スタイルシート
│   └── images/           # 画像ファイル
├── public/               # 公開される静的ファイル
├── app.vue               # アプリケーションのルートコンポーネント
└── nuxt.config.ts        # Nuxt設定ファイル
```

## コーディング規約

### コンポーネント命名規則

- **コンポーネントファイル**: PascalCase（例: `Header.vue`, `Button.vue`）
- **コンポーネント分類**:
  - `components/app/` - アプリケーション全体で使用されるコンポーネント（例: `Header.vue` → `<AppHeader />`）
  - `components/base/` - 基本的な再利用可能なコンポーネント（例: `Button.vue` → `<BaseButton />`）
  - `components/features/` - 機能ごとのコンポーネント（将来的に追加）
- **Nuxt 3/4の自動インポート**: 
  - `components/`ディレクトリ内のコンポーネントは自動的にインポートされる
  - サブディレクトリ内のコンポーネントには、ディレクトリ名が自動的にプレフィックスとして付く
  - 例: `components/app/Header.vue` → `<AppHeader />`, `components/base/Button.vue` → `<BaseButton />`
- **ページコンポーネント**: `pages/`ディレクトリ内はファイルベースルーティング

### TypeScript

- すべての`.vue`ファイルで`<script setup lang="ts">`を使用
- 型定義は`interface`または`type`を使用
- `defineProps`, `defineEmits`で型推論を活用
- Nuxt 3/4のComposablesは自動インポート（`useRouter`, `useRoute`, `useState`など）

### スタイリング

- **Scoped CSS**: 各コンポーネントで`<style scoped>`を使用
- **グローバルスタイル**: `assets/css/main.css`に配置
- **CSS変数**: 必要に応じて使用（ダークモード対応など）

### Vue 3 Composition API

- **Script Setup**: `<script setup lang="ts">`を使用（推奨）
- **Composables**: 再利用可能なロジックは`composables/`に配置
- **Reactivity**: `ref`, `reactive`, `computed`, `watch`を適切に使用
- **Lifecycle**: `onMounted`, `onUnmounted`などを使用

### Nuxt 4の特徴

- **自動インポート**: コンポーネント、Composables、ユーティリティが自動インポート
- **SSG**: `nuxt generate`で静的サイト生成
- **TypeScript**: 完全なTypeScriptサポート
- **HMR**: 開発時のホットモジュールリロード

## ベストプラクティス

### コンポーネント作成

1. **コンポーネント分類**:
   - `components/app/` - アプリケーション全体で使用されるコンポーネント（Header, Footer, Navigationなど）
   - `components/base/` - 基本的な再利用可能なコンポーネント（Button, Card, Input, Badgeなど）
   - `components/features/` - 機能ごとのコンポーネント（例: `works/WorkCard.vue`, `contact/ContactForm.vue`など）
     - 特定の機能やページで使用されるコンポーネントを機能ごとに分類
     - 将来的に機能が増えた場合、`components/features/works/`, `components/features/contact/`のように分類
2. **コンポーネント名**: 各分類ディレクトリ内にPascalCaseで配置
   - 例: `components/app/Header.vue` → `<AppHeader />`
   - 例: `components/base/Button.vue` → `<BaseButton />`
3. **Props**: `defineProps`で型定義
4. **Events**: `defineEmits`で型定義
5. **Slots**: 必要に応じて名前付きスロットを使用

### ページ作成

1. **ファイルベースルーティング**: `pages/`ディレクトリに配置
2. **レイアウト**: `layouts/default.vue`を使用（デフォルト）
3. **メタデータ**: `useHead`または`useSeoMeta`を使用

### Composables作成

1. **命名規則**: `use`プレフィックス（例: `useTheme.ts`）
2. **エクスポート**: 名前付きエクスポートで関数を返す
3. **型定義**: 返り値の型を明示的に定義

### ユーティリティ関数

1. **純粋関数**: 副作用のない純粋関数を推奨
2. **型定義**: 引数と返り値の型を明示

## コード品質ツール

### ESLint

- **設定ファイル**: `app/.eslintrc.cjs`
- **プラグイン**: 
  - `eslint-plugin-vue`: Vue 3用
  - `eslint-plugin-nuxt`: Nuxt 3/4用
  - `@typescript-eslint`: TypeScript用
- **実行**: `make lint`または`npm run lint`
- **自動修正**: `make lint-fix`または`npm run lint:fix`

### Prettier

- **設定ファイル**: `app/.prettierrc`
- **実行**: `make format`または`npm run format`
- **チェック**: `make format-check`または`npm run format:check`

### Pre-commitフック

- **ファイル**: `pre-commit`
- **自動実行**: Gitコミット前にESLintとPrettierを自動実行
- **設定**: `make init`で自動的に設置

## Docker環境

### 開発環境

- **コンテナ名**: `.env`の`CONTAINER_NAME`で設定（デフォルト: `nuxt-portfolio`）
- **ポート**: `.env`の`HOST_PORT`で設定（デフォルト: `3000`）
- **ボリュームマウント**: `./app:/app`（ホットリロード有効）
- **コマンド**: `make dev`で開発サーバー起動

### ビルド

- **Dockerfile**: `docker/Dockerfile`
- **マルチステージビルド**: `dev`, `builder`, `runner`ステージ
- **ベースイメージ**: `node:20-alpine`

## ファイル作成時の注意事項

### 新しいコンポーネント

```vue
<template>
  <div class="my-component">
    <!-- コンテンツ -->
  </div>
</template>

<script setup lang="ts">
// Props定義
const props = defineProps<{
  title: string
  optional?: string
}>()

// Emits定義（必要な場合）
const emit = defineEmits<{
  (e: 'click', value: string): void
}>()

// ロジック
const handleClick = () => {
  emit('click', 'value')
}
</script>

<style scoped>
.my-component {
  /* スタイル */
}
</style>
```

### 新しいページ

```vue
<template>
  <div class="page-container">
    <h1>ページタイトル</h1>
    <!-- コンテンツ -->
  </div>
</template>

<script setup lang="ts">
// メタデータ（必要に応じて）
useHead({
  title: 'ページタイトル',
  meta: [
    { name: 'description', content: 'ページの説明' }
  ]
})
</script>

<style scoped>
.page-container {
  /* スタイル */
}
</style>
```

### 新しいComposable

```typescript
export const useMyComposable = () => {
  const state = useState('my-state', () => ref(0))
  
  const increment = () => {
    state.value++
  }
  
  return {
    state: readonly(state),
    increment
  }
}
```

## 禁止事項

- ❌ `process.client`の使用 → `import.meta.client`または`typeof window !== 'undefined'`を使用
- ❌ `process.server`の使用 → `import.meta.server`を使用
- ❌ コンポーネントの手動インポート → 自動インポートを活用
- ❌ `@/`エイリアスの使用 → `~/`エイリアスを使用（Nuxt標準）
- ❌ `vue-router`の直接インポート → `useRouter`, `useRoute`を使用

## 参考資料

- [Nuxt 4 Documentation](https://nuxt.com/docs)
- [Vue 3 Documentation](https://vuejs.org/)
- [TypeScript Handbook](https://www.typescriptlang.org/docs/)

## 重要事項

⚠️ **Nuxt 4の最新機能を活用すること**
- `import.meta.client` / `import.meta.server`を使用
- 自動インポート機能を最大限活用
- TypeScriptの型推論を活用
- SSGの最適化を考慮

⚠️ **コード品質を保つこと**
- コミット前にESLintとPrettierを実行
- 型定義を適切に行う
- コンポーネントを適切に分割
- 再利用可能なロジックはComposablesに抽出

